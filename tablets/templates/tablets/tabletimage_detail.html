{% extends "webpage/base.html" %}

{% load staticfiles %}
{% block scriptHeader %}<!--leafletjs -->
    <link rel="stylesheet" href="{% static 'webpage/libraries/leaflet/leaflet.css' %}"/></link>
    <script src="{% static 'webpage/libraries/leaflet/leaflet.js' %}"></script>
        <style>
            #map { height: 500px; }
        </style>
{% endblock %}
{% block content %}
<div class="panel panel-default">
    <div class="panel-heading">
        <h2>Image of Tablet {{ object.tablet }}<span id="clickme" title="click to toggle info" class="glyphicon glyphicon-info-sign" aria-hidden="true"></span></h2>
    </div>
        <div class="panel panel-body">
            <div class="row">
                <div class="col-md-5">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3>Metadata
                                {% if user.is_authenticated %}
                                    <a href="{% url 'tablets:tabletimg_edit' pk=object.id %}" class="glyphicon glyphicon-edit" aria-hidden="true" title="edit Tablet Image"></a> | <a href="{% url 'tablets:tabletimage_cut' pk=object.id %}" class="glyphicon glyphicon-scissors" aria-hidden="true" title="create new Glyph out of Tablet Image"></a> | <a href="{% url 'tablets:tabletimage_delete' pk=object.id %}" class="glyphicon glyphicon-remove-circle" aria-hidden="true" title="delete Tablet Image"></a>
                                {% endif %}
                            </h3>
                        </div>
                        <div class="panel panel-body">
                            <div style="text-align:center; padding:20px;">
                                <img src="{% url 'protected_server' pic=object.filename %}" width="300">
                            </div>
                            <table class="table table-bordered table-hover table-condensed">
                                <tr>
                                    <th class="col-sm-3">Tablet</th>
                                    <td class="readmore col-sm-3"><small></small></td>
                                    <td class="col-sm-6"><a href="{% url 'tablets:tablet_detail' pk=object.tablet.id %}">{{ object.tablet }}</a></td>
                                </tr>
                                <tr>
                                    <th>Comment</th>
                                    <td class="readmore"><small></small></td>
                                    <td>{{ object.comment }}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-md-7">
                    <div class="panel panel-default">
                    <div class="panel panel-heading">
                        Glyphs
                    </div>
                    <div class="panel panel-body">
                        <div id="show-glyphs">
                            <table class="table table-hover table-striped table-condensed">
                                <tr>
                                    <th>Sign</th>
                                    <th>ABZ-Number</th>
                                    <th>reading</th>
                                    <th>Glyph</th>
                                </tr>
                                {% for x in glyph_list %}
                                    <tr>
                                        <td><a href="{% url 'tablets:sign_detail' pk=x.sign.id %}">{{ x.sign }}</a></td>
                                        <td>{{ x.sign.abz_number }}</td>
                                        <td><a href="{% url 'tablets:glyph_detail' pk=x.id %}">{{ x.reading }}</a></td>
                                        <td>
                                            <img src="/media/glyph_img/{{ x.filename }}" width="50px"></img>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
</div>

<script type="text/javascript">
    $(document).ready(function(){
        $( "td[class~='readmore']" ).hide();
    })
    $("#clickme").click(function(){
        $( "td[class~='readmore']" ).toggle("slow");
    })  
</script>

<!-- <script type="text/javascript">
    $( document ).ready(function() {
        var map = L.map('map').setView([48.69096, 9.14062], 5);

        L.tileLayer('http://otile1.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.jpg', {
        attribution: 'Data, imagery and map information provided by MapQuest, OpenStreetMap <http://www.openstreetmap.org/copyright> and contributors, ODbL <http://wiki.openstreetmap.org/wiki/Legal_FAQ#3a._I_would_like_to_use_OpenStreetMap_maps._How_should_I_credit_you.3F>',
        maxZoom: 18
        }).addTo(map);

        {% for x in object.institution.all %} 
        {% if x.lat %}
        L.marker([{{ x.lat }}, {{ x.lng }}])
        .addTo(map)
        .bindPopup("<h3> {{object.name}}</h3><table class='table table-striped'> <tr> <td>responsible Institution: </td> <td>{{ x.name }}</td> </tr> <tr> <td>located in: </td> <td>{{ x.place.name }} ({{ x.place.part_of.name }})</td> </tr><tr> <td>more projects from this institution: </td> <td><a href='{% url 'browsing:browse_editions' %}?name=&institution__name={{x.name}}'>{{ x.name }}</a></td> </tr>  </table>");
        {% endif %}
        {% endfor %}
        });
</script> -->
{% endblock %}

